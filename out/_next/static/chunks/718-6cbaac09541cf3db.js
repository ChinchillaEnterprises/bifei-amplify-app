"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[718],{76718:(e,t,i)=>{function n(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}i.d(t,{E:()=>q});var r=function e(t,i){function r(e,r,s){if("undefined"!=typeof document){"number"==typeof(s=n({},i,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var d="";for(var o in s)s[o]&&(d+="; "+o,!0!==s[o]&&(d+="="+s[o].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+d}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var i=document.cookie?document.cookie.split("; "):[],n={},r=0;r<i.length;r++){var s=i[r].split("="),d=s.slice(1).join("=");try{var o=decodeURIComponent(s[0]);if(n[o]=t.read(d,o),e===o)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){r(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class s{constructor(e={}){let{path:t,domain:i,expires:n,sameSite:r,secure:s}=e;if(this.domain=i,this.path=t||"/",this.expires=Object.prototype.hasOwnProperty.call(e,"expires")?n:365,this.secure=!Object.prototype.hasOwnProperty.call(e,"secure")||s,Object.prototype.hasOwnProperty.call(e,"sameSite")){if(!r||!["strict","lax","none"].includes(r))throw Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if("none"===r&&!this.secure)throw Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=r}}async setItem(e,t){r.set(e,t,this.getData())}async getItem(e){return r.get(e)??null}async removeItem(e){r.remove(e,this.getData())}async clear(){let e=Object.keys(r.get()).map(e=>this.removeItem(e));await Promise.all(e)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}var d=i(60319),o=i(36035),a=i(20468),c=i(29293);i(86890),i(68021);var l=i(86976),h=i(8352),y=i(31851),u=i(2954),I=i(14330),p=i(74172);let g="cognito-identity",C={service:g,retryDecider:(0,p.D)(y.F),computeDelay:I.y,cache:"no-store"};var f=i(5843);let m=(0,i(82590).q)(f.F,[()=>e=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),w=e=>(t,i)=>A(i,v(e),JSON.stringify(t)),v=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),A=({url:e},t,i)=>({headers:t,url:e,body:i,method:"POST"}),S=e=>(0,u.A)(m,w("GetCredentialsForIdentity"),_,{...C,...e,userAgentValue:(0,l.fE)()}),_=async e=>{if(e.statusCode>=300)throw await (0,y.F)(e);let t=await (0,y.Y)(e);return{IdentityId:t.IdentityId,Credentials:k(t.Credentials),$metadata:(0,h.j)(e)}},k=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(1e3*e)});var T=i(98785),x=i(85199),E=i(40002),K=i(89492),b=i(92193),P=i(79096),O=i(99896);let D=({endpointOverride:e})=>t=>e?{url:new O.o(e)}:(({region:e})=>({url:new O.o(`https://${g}.${e}.${(0,P.R)(e)}`)}))(t),R=async e=>{if(e.statusCode>=300)throw await (0,y.F)(e);return{IdentityId:(await (0,y.Y)(e)).IdentityId,$metadata:(0,h.j)(e)}};function j(e){let t=(0,T.Cq)(e).payload.iss,i={};if(!t)throw new x.l({name:"InvalidIdTokenException",message:"Invalid Idtoken."});return i[t.replace(/(^\w+:|^)\/\//,"")]=e,i}async function F({tokens:e,authConfig:t,identityIdStore:i}){i.setAuthConfig({Cognito:t});let n=await i.loadIdentityId();if(n)return n.id;let r=e?.idToken?j(e.idToken.toString()):{},s=await G(r,t);return i.storeIdentityId({id:s,type:e?"primary":"guest"}),s}async function G(e,t){let i,n,r=t?.identityPoolId,s=(0,K.C)(r),d=(n={endpointResolver:D({endpointOverride:t.identityPoolEndpoint})},(0,u.A)(m,w("GetId"),R,{...C,...n,userAgentValue:(0,l.fE)()}));try{i=(await d({region:s},{IdentityPoolId:r,Logins:e})).IdentityId}catch(e){throw(0,E.e)(e),new x.l(e)}if(!i)throw new x.l({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return i}let L=new c.C("CognitoCredentialsProvider");class V{constructor(e){this._nextCredentialsRefresh=0,this._identityIdStore=e}async clearCredentialsAndIdentityId(){L.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){L.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(e){let t=e.authenticated,{tokens:i}=e,{authConfig:n}=e;try{(0,T.Eh)(n?.Cognito)}catch{return}if(!t&&!n.Cognito.allowGuestAccess)return;let{forceRefresh:r}=e,s=this.hasTokenChanged(i),d=await F({tokens:i,authConfig:n.Cognito,identityIdStore:this._identityIdStore});return((r||s)&&this.clearCredentials(),t)?((0,b.OW)(i),this.credsForOIDCTokens(n.Cognito,i,d)):this.getGuestCredentials(d,n.Cognito)}async getGuestCredentials(e,t){let i;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!1===this._credentialsAndIdentityId.isAuthenticatedCreds)return L.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();let n=(0,K.C)(t.identityPoolId),r=S({endpointResolver:D({endpointOverride:t.identityPoolEndpoint})});try{i=await r({region:n},{IdentityId:e})}catch(e){throw(0,E.e)(e),new x.l(e)}if(i?.Credentials?.AccessKeyId&&i?.Credentials?.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+3e6;let t={credentials:{accessKeyId:i.Credentials.AccessKeyId,secretAccessKey:i.Credentials.SecretKey,sessionToken:i.Credentials.SessionToken,expiration:i.Credentials.Expiration},identityId:e};return i.IdentityId&&(t.identityId=i.IdentityId,this._identityIdStore.storeIdentityId({id:i.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...t,isAuthenticatedCreds:!1},t}throw new x.l({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(e,t,i){let n;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!0===this._credentialsAndIdentityId.isAuthenticatedCreds)return L.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();let r=t.idToken?j(t.idToken.toString()):{},s=(0,K.C)(e.identityPoolId),d=S({endpointResolver:D({endpointOverride:e.identityPoolEndpoint})});try{n=await d({region:s},{IdentityId:i,Logins:r})}catch(e){throw(0,E.e)(e),new x.l(e)}if(n?.Credentials?.AccessKeyId&&n?.Credentials?.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+3e6;let e={credentials:{accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.SecretKey,sessionToken:n.Credentials.SessionToken,expiration:n.Credentials.Expiration},identityId:i};return n.IdentityId&&(e.identityId=n.IdentityId,this._identityIdStore.storeIdentityId({id:n.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...e,isAuthenticatedCreds:!0,associatedIdToken:t.idToken?.toString()},e}throw new x.l({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return void 0===this._nextCredentialsRefresh||this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(e){return!!e&&!!this._credentialsAndIdentityId?.associatedIdToken&&e.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}}var H=i(94886);let U={identityId:"identityId"},$=new c.C("DefaultIdentityIdStore");class N{setAuthConfig(e){(0,T.Eh)(e.Cognito),this.authConfig=e,this._authKeys=Q("Cognito",e.Cognito.identityPoolId)}constructor(e){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=e}async loadIdentityId(){(0,T.Eh)(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{let e=await this.keyValueStorage.getItem(this._authKeys.identityId);if(e)return this._hasGuestIdentityId=!0,{id:e,type:"guest"};return null}}catch(e){return $.log("Error getting stored IdentityId.",e),null}}async storeIdentityId(e){(0,T.Eh)(this.authConfig?.Cognito),"guest"===e.type?(this.keyValueStorage.setItem(this._authKeys.identityId,e.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=e.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}let Q=(e,t)=>(0,H.Qm)(U)(`com.amplify.${e}`,t),z=new V(new N(d.ZL));var B=i(27263);let q={configure(e,t){let i=(0,a.M)(e),n=new s({sameSite:"lax"}),r=t?.ssr?n:d.ZL,c=t?.ssr?new V(new N(n)):z;if(!i.Auth||t?.Auth)return void o.H.configure(i,t);if(!o.H.libraryOptions.Auth){B.Q.setAuthConfig(i.Auth),B.Q.setKeyValueStorage(r),o.H.configure(i,{...t,Auth:{tokenProvider:B.Q,credentialsProvider:c}});return}if(t){let e=o.H.libraryOptions.Auth;void 0!==t.ssr&&(B.Q.setKeyValueStorage(r),e.credentialsProvider=c),o.H.configure(i,{Auth:e,...t});return}o.H.configure(i)},getConfig:()=>o.H.getConfig()}}}]);