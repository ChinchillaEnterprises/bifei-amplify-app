(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{66038:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(95155),l=s(12115),a=s(35695),n=s(82885),i=s(84462),o=s(92210),d=s(37016);function c(){let e=(0,a.useRouter)(),[t,s]=(0,l.useState)(""),[c,h]=(0,l.useState)(""),[u,x]=(0,l.useState)(""),[m,g]=(0,l.useState)(""),[p,f]=(0,l.useState)(!1),[b,v]=(0,l.useState)(""),[j,y]=(0,l.useState)(!1),N=async e=>{if(e.preventDefault(),v(""),c!==u)return void v("Passwords do not match");if(c.length<8)return void v("Password must be at least 8 characters");y(!0);try{let{isSignUpComplete:e,nextStep:s}=await (0,i.H)({username:t,password:c,options:{userAttributes:{email:t}}});"CONFIRM_SIGN_UP"===s.signUpStep&&f(!0)}catch(e){v(e.message||"Failed to sign up")}finally{y(!1)}},w=async s=>{s.preventDefault(),v(""),y(!0);try{let{isSignUpComplete:s}=await (0,o.z)({username:t,confirmationCode:m});s&&(await (0,d.J)({username:t,password:c}),"haobifei@gmail.com"===t?alert("Success! You have been assigned as a Restaurant Host."):"admin@goldendragon.com"===t?alert("Success! You have been assigned as a Maintenance Admin."):alert("Success! You have been registered as a Customer."),e.push("/"))}catch(e){v(e.message||"Failed to confirm sign up")}finally{y(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-white",children:[(0,r.jsx)(n.A,{}),(0,r.jsx)("div",{className:"flex items-center justify-center py-12 px-4",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-red-900 mb-6 text-center",children:p?"Confirm Your Account":"Create Account"}),(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"Test Users:"}),(0,r.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Restaurant Host:"})," haobifei@gmail.com / haobifei"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Maintenance:"})," admin@goldendragon.com / Admin123!"]}),(0,r.jsxs)("li",{children:["• ",(0,r.jsx)("strong",{children:"Customer:"})," Any other email"]})]})]}),b&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:b}),p?(0,r.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:["We've sent a confirmation code to ",t,". Please enter it below."]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"code",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmation Code"}),(0,r.jsx)("input",{type:"text",id:"code",value:m,onChange:e=>g(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Enter 6-digit code"})]}),(0,r.jsx)("button",{type:"submit",disabled:j,className:"w-full py-3 rounded-lg font-semibold text-white transition ".concat(j?"bg-gray-400 cursor-not-allowed":"bg-red-800 hover:bg-red-700"),children:j?"Confirming...":"Confirm Account"})]}):(0,r.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",value:t,onChange:e=>s(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Enter your email"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,r.jsx)("input",{type:"password",id:"password",value:c,onChange:e=>h(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Minimum 8 characters"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),(0,r.jsx)("input",{type:"password",id:"confirmPassword",value:u,onChange:e=>x(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Re-enter your password"})]}),(0,r.jsx)("button",{type:"submit",disabled:j,className:"w-full py-3 rounded-lg font-semibold text-white transition ".concat(j?"bg-gray-400 cursor-not-allowed":"bg-red-800 hover:bg-red-700"),children:j?"Creating Account...":"Sign Up"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsx)("a",{href:"/login",className:"text-red-600 hover:text-red-700",children:"Already have an account? Sign In"})})]})})})]})}},82885:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var r=s(95155),l=s(12115),a=s(6874),n=s.n(a),i=s(35695),o=s(88304);function d(){let[e,t]=(0,l.useState)(!1),{user:s,userAttributes:a,userGroups:d,signOutUser:c,isInGroup:h}=(0,o.A)(),u=(0,i.useRouter)(),x=async()=>{await c(),u.push("/"),u.refresh()},m=()=>{var e;return(null==a?void 0:a.preferred_username)?a.preferred_username:(null==a?void 0:a.email)?a.email.split("@")[0]:(null==s||null==(e=s.signInDetails)?void 0:e.loginId)?s.signInDetails.loginId.split("@")[0]:(null==s?void 0:s.username)?s.username:"User"};return(0,r.jsxs)("nav",{className:"bg-red-800 shadow-lg sticky top-0 z-50",children:[(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)(n(),{href:"/",className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-2xl font-bold text-gold",children:"\uD83E\uDD5F"}),(0,r.jsx)("span",{className:"text-xl font-bold text-white",children:"Golden Dragon"}),(0,r.jsx)("span",{className:"text-sm text-gold ml-2",children:"金龙餐厅"})]})}),(0,r.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,r.jsx)(n(),{href:"/",className:"text-white hover:text-gold transition",children:"Home"}),(0,r.jsx)(n(),{href:"/menu",className:"text-white hover:text-gold transition",children:"Menu"}),(0,r.jsx)(n(),{href:"/delivery",className:"text-white hover:text-gold transition",children:"Delivery"}),(0,r.jsx)(n(),{href:"/reservation",className:"text-white hover:text-gold transition",children:"Reservation"}),(0,r.jsx)(n(),{href:"/location",className:"text-white hover:text-gold transition",children:"Location"}),s&&h("restaurantHost")&&(0,r.jsx)(n(),{href:"/admin/host",className:"text-white hover:text-gold transition",children:"Host Dashboard"}),s&&h("maintenance")&&(0,r.jsx)(n(),{href:"/admin/maintenance",className:"text-white hover:text-gold transition",children:"Admin"}),s?(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-gold text-sm font-semibold",children:["\uD83D\uDC64 Welcome, ",m()]}),(0,r.jsx)("button",{onClick:x,className:"bg-gold text-red-900 px-3 py-2 rounded-lg hover:bg-yellow-400 transition font-semibold text-sm",children:"Sign Out"})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(n(),{href:"/signup",className:"text-white hover:text-gold transition font-semibold",children:"Sign Up"}),(0,r.jsx)(n(),{href:"/login",className:"bg-gold text-red-900 px-4 py-2 rounded-lg hover:bg-yellow-400 transition font-semibold",children:"Login"})]})]}),(0,r.jsx)("div",{className:"md:hidden flex items-center",children:(0,r.jsx)("button",{onClick:()=>t(!e),className:"text-white hover:text-gold focus:outline-none",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e?(0,r.jsx)("path",{d:"M6 18L18 6M6 6l12 12"}):(0,r.jsx)("path",{d:"M4 6h16M4 12h16M4 18h16"})})})})]})}),e&&(0,r.jsx)("div",{className:"md:hidden bg-red-700",children:(0,r.jsxs)("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[(0,r.jsx)(n(),{href:"/",className:"block px-3 py-2 text-white hover:text-gold",children:"Home"}),(0,r.jsx)(n(),{href:"/menu",className:"block px-3 py-2 text-white hover:text-gold",children:"Menu"}),(0,r.jsx)(n(),{href:"/delivery",className:"block px-3 py-2 text-white hover:text-gold",children:"Delivery"}),(0,r.jsx)(n(),{href:"/reservation",className:"block px-3 py-2 text-white hover:text-gold",children:"Reservation"}),(0,r.jsx)(n(),{href:"/location",className:"block px-3 py-2 text-white hover:text-gold",children:"Location"}),s&&h("restaurantHost")&&(0,r.jsx)(n(),{href:"/admin/host",className:"block px-3 py-2 text-white hover:text-gold",children:"Host Dashboard"}),s&&h("maintenance")&&(0,r.jsx)(n(),{href:"/admin/maintenance",className:"block px-3 py-2 text-white hover:text-gold",children:"Admin"}),s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"block px-3 py-2 text-gold text-sm font-semibold",children:["\uD83D\uDC64 Welcome, ",m()]}),(0,r.jsx)("button",{onClick:x,className:"block w-full text-left px-3 py-2 text-white hover:text-gold",children:"Sign Out"})]}):(0,r.jsx)(n(),{href:"/login",className:"block px-3 py-2 text-white hover:text-gold",children:"Login"})]})})]})}},86506:(e,t,s)=>{Promise.resolve().then(s.bind(s,66038))},88304:(e,t,s)=>{"use strict";s.d(t,{A:()=>h,default:()=>u});var r=s(95155),l=s(12115),a=s(69414),n=s(52248),i=s(59995),o=s(53732),d=s(29020);let c=(0,l.createContext)({user:null,userAttributes:null,userGroups:[],loading:!0,checkUser:async()=>{},signOutUser:async()=>{},isInGroup:()=>!1}),h=()=>(0,l.useContext)(c);function u(e){let{children:t}=e,[s,h]=(0,l.useState)(null),[u,x]=(0,l.useState)(null),[m,g]=(0,l.useState)([]),[p,f]=(0,l.useState)(!0),b=async()=>{try{let r=await (0,n.H)();h(r);try{let e=await (0,i.T)();x(e)}catch(e){console.log("Could not fetch attributes:",e)}try{var e,t,s;let r=(null==(s=(await (0,o.$)()).tokens)||null==(t=s.accessToken)||null==(e=t.payload)?void 0:e["cognito:groups"])||[];g(r)}catch(e){console.log("Could not fetch user groups:",e),g([])}}catch(e){h(null),x(null),g([])}finally{f(!1)}},v=async()=>{try{await (0,d.C)(),h(null),x(null),g([])}catch(e){console.error("Error signing out:",e)}};return(0,l.useEffect)(()=>(b(),a.YZ.listen("auth",e=>{let{payload:t}=e;switch(t.event){case"signedIn":case"tokenRefresh":b();break;case"signedOut":case"tokenRefresh_failure":h(null),x(null),g([])}})),[]),(0,r.jsx)(c.Provider,{value:{user:s,userAttributes:u,userGroups:m,loading:p,checkUser:b,signOutUser:v,isInGroup:e=>m.includes(e)},children:t})}}},e=>{e.O(0,[218,244,112,441,964,358],()=>e(e.s=86506)),_N_E=e.O()}]);