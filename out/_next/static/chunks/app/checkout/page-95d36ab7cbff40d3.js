(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{28754:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>m});var a=r(95155),t=r(12115),l=r(82885),n=r(6874),d=r.n(n),i=r(35695),c=r(39040),o=r(88304);function m(){let e=(0,i.useRouter)(),{user:s}=(0,o.A)(),[r,n]=(0,t.useState)([]),[m,x]=(0,t.useState)({name:"",phone:"",email:"",address:"",city:"",zipCode:"",cardNumber:"",cardName:"",expiry:"",cvv:"",instructions:""}),[u,h]=(0,t.useState)(!1),[g,p]=(0,t.useState)(!1);(0,t.useEffect)(()=>{let s=localStorage.getItem("goldenDragonCart");s?n(JSON.parse(s)):e.push("/delivery")},[e]);let y=e=>{let{name:s,value:r}=e.target;x(e=>({...e,[s]:r}))},b=(e,s)=>{if(s<=0){let s=r.filter(s=>s.id!==e);n(s),localStorage.setItem("goldenDragonCart",JSON.stringify(s))}else{let a=r.map(r=>r.id===e?{...r,quantity:s}:r);n(a),localStorage.setItem("goldenDragonCart",JSON.stringify(a))}},j=()=>r.reduce((e,s)=>e+s.price*s.quantity,0),N=()=>.08*j(),f=()=>j()>=30?0:4.99,v=()=>j()+N()+f(),w=async a=>{a.preventDefault(),h(!0);try{let{data:a}=await c.S.models.Order.create({customerName:m.name,phone:m.phone,email:m.email,deliveryAddress:"".concat(m.address,", ").concat(m.city," ").concat(m.zipCode),items:r.map(e=>({name:e.name,price:e.price,quantity:e.quantity})),subtotal:j(),tax:N(),deliveryFee:f(),total:v(),specialInstructions:m.instructions||null,userId:(null==s?void 0:s.userId)||"guest"});a&&(p(!0),localStorage.removeItem("goldenDragonCart"),setTimeout(()=>{e.push("/")},3e3))}catch(e){console.error("Error creating order:",e),alert("Sorry, there was an error processing your order. Please try again.")}finally{h(!1)}};return g?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-white",children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[80vh]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-bounce mb-6",children:(0,a.jsx)("span",{className:"text-8xl",children:"✅"})}),(0,a.jsx)("h1",{className:"text-4xl font-bold text-red-900 mb-4",children:"Order Confirmed!"}),(0,a.jsx)("p",{className:"text-xl text-gray-700 mb-2",children:"Thank you for your order!"}),(0,a.jsx)("p",{className:"text-lg text-gray-600",children:"Your food will arrive in 30-45 minutes"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"Redirecting to home page..."})]})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-red-50 to-white",children:[(0,a.jsx)(l.A,{}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-red-900 to-red-700 py-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-white",children:"Checkout"}),(0,a.jsx)("p",{className:"text-gold mt-2",children:"Complete your order"})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"Delivery Information"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),(0,a.jsx)("input",{type:"text",name:"name",required:!0,value:m.name,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),(0,a.jsx)("input",{type:"tel",name:"phone",required:!0,value:m.phone,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),(0,a.jsx)("input",{type:"email",name:"email",required:!0,value:m.email,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delivery Address *"}),(0,a.jsx)("input",{type:"text",name:"address",required:!0,value:m.address,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),(0,a.jsx)("input",{type:"text",name:"city",required:!0,value:m.city,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ZIP Code *"}),(0,a.jsx)("input",{type:"text",name:"zipCode",required:!0,value:m.zipCode,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"Payment Information"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Number *"}),(0,a.jsx)("input",{type:"text",name:"cardNumber",required:!0,placeholder:"1234 5678 9012 3456",value:m.cardNumber,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name on Card *"}),(0,a.jsx)("input",{type:"text",name:"cardName",required:!0,value:m.cardName,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expiry Date *"}),(0,a.jsx)("input",{type:"text",name:"expiry",required:!0,placeholder:"MM/YY",value:m.expiry,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CVV *"}),(0,a.jsx)("input",{type:"text",name:"cvv",required:!0,placeholder:"123",value:m.cvv,onChange:y,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"Special Instructions"}),(0,a.jsx)("textarea",{name:"instructions",rows:3,value:m.instructions,onChange:y,placeholder:"Any special requests or delivery instructions...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"})]}),(0,a.jsx)("button",{type:"submit",disabled:u||0===r.length,className:"w-full py-4 rounded-lg font-bold text-white transition ".concat(u||0===r.length?"bg-gray-400 cursor-not-allowed":"bg-red-800 hover:bg-red-700 transform hover:scale-105"),children:u?(0,a.jsxs)("span",{className:"flex items-center justify-center",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing Payment..."]}):"Place Order - $".concat(v().toFixed(2))})]})}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 sticky top-20",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"Order Summary"}),0===r.length?(0,a.jsx)("p",{className:"text-gray-500",children:"Your cart is empty"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"space-y-4 mb-6 max-h-96 overflow-y-auto",children:r.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-start border-b pb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.nameZh}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)("button",{onClick:()=>b(e.id,e.quantity-1),className:"bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300",children:"-"}),(0,a.jsx)("span",{className:"mx-3 font-medium",children:e.quantity}),(0,a.jsx)("button",{onClick:()=>b(e.id,e.quantity+1),className:"bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300",children:"+"})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"font-semibold",children:["$",(e.price*e.quantity).toFixed(2)]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["$",e.price," each"]})]})]},e.id))}),(0,a.jsxs)("div",{className:"space-y-2 border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Subtotal"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",j().toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Tax (8%)"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",N().toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Delivery Fee"}),(0,a.jsx)("span",{className:"font-medium",children:0===f()?(0,a.jsx)("span",{className:"text-green-600",children:"FREE"}):"$".concat(f().toFixed(2))})]}),f()>0&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Free delivery on orders over $30"}),(0,a.jsxs)("div",{className:"flex justify-between text-xl font-bold text-red-900 pt-4 border-t",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:["$",v().toFixed(2)]})]})]}),(0,a.jsx)(d(),{href:"/delivery",className:"block text-center mt-6 text-red-600 hover:text-red-700 font-medium",children:"← Back to Menu"})]})]})})]})})]})}},93902:(e,s,r)=>{Promise.resolve().then(r.bind(r,28754))}},e=>{e.O(0,[218,244,718,232,124,441,964,358],()=>e(e.s=93902)),_N_E=e.O()}]);